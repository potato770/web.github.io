<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>è™›æ“¬è²¨å¹£æŠ•è³‡å¹³å°</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="container">
    <!-- Header -->
    <div class="header">
      <h1>è™›æ“¬è²¨å¹£æŠ•è³‡å¹³å°</h1>
      <select class="dropdown" id="moreOptions" onchange="handleDropdownChange()">
        <option value="">é¸æ“‡æ“ä½œ</option>
        <option value="transfer">è½‰å¸³</option>
        <option value="withdraw">æç¾</option>
      </select>
    </div>

    <!-- å³æ™‚å›å ±å€åŸŸ -->
    <div id="realtimeReport" class="realtime-report">
      <h3>å³æ™‚å›å ±</h3>
      <p>å¸³æˆ¶ç¸½é¡: <span id="accountTotal">$2000</span></p>
      <p>ç›®å‰å›å ±: <span id="currentReturn">$0</span></p>
      <p>é¸æ“‡çš„å¹£ç¨®åƒ¹æ ¼: <span id="currentCurrencyPrice">$30,000</span></p>
    </div>

    <div id="investmentPanel" class="card">
      <h2>æŠ•è³‡è™›æ“¬è²¨å¹£</h2>
      <div class="info">
        <label for="currencySelect"><strong>é¸æ“‡å¹£ç¨®</strong></label>
        <select id="currencySelect" onchange="updateCurrencyDetails()">
          <option value="BTC" data-price="30000">æ¯”ç‰¹å¹£ (BTC)</option>
          <option value="ETH" data-price="2000">ä»¥å¤ªåŠ (ETH)</option>
          <option value="LTC" data-price="150">èŠç‰¹å¹£ (LTC)</option>
        </select>
        <p>å³æ™‚å¹£åƒ¹: <span id="currencyPriceDisplay">$30,000</span></p>
      </div>
    
      <div class="account-info">
        <label for="investmentAmount"><strong>è¼¸å…¥æŠ•è³‡é‡‘é¡</strong></label>
        <input type="number" id="investmentAmount" min="1" oninput="updateEstimates()" />
        <p>å¯è³¼è²·æ•¸é‡: <span id="estimatedUnits">0</span> <span id="currencySymbol">BTC</span></p>
        <p>é ä¼°æ”¶ç›Šç¯„åœ: <span id="estimatedProfit">$0.00 ~ $0.00</span></p>
      </div>
    
      <button class="button" onclick="confirmInvestment()">ç¢ºèªè²·å…¥</button>
    </div>

    <div id="purchaseSuccess" class="hidden">è³¼è²·æˆåŠŸï¼</div>

    <div id="subtitleOverlay" class="hidden">
      <p>éäº†å¹¾å¤©....</p>
    </div>


    <!-- æŠ•è³‡çµæœå€åŸŸ -->
    <div id="investmentResult" class="investment-result result">
      <p>æŠ•è³‡æˆåŠŸï¼æ‚¨å·²æˆåŠŸè³¼è²· <span id="currencyPurchased">0.00</span> <span id="currencySymbol">BTC</span>ã€‚</p>
      <p>å¸³æˆ¶é¤˜é¡: <span id="newAccountBalance">$0</span></p>
    </div>
  </div>

  <!-- åŠ ç¢¼é¸é …å½ˆçª— -->
  <div id="followUpOptions" class="card followup-options">
    <button onclick="handleFollowUpOption('A')" class="button">åŠ ç¢¼æŠ•è³‡ $1000</button>
    <button onclick="handleFollowUpOption('B')" class="button">é‚„æ˜¯å…ˆæŠ• $500 å¥½äº†</button>
  </div>

  <!-- è‡ªè¨‚æç¤º -->
  <div id="customAlert" class="custom-alert hidden">
    <div class="alert-box">
      <strong>âš  æŠ•è³‡é‡‘é¡ä¸è¶³</strong>
      <p>è«‹å…ˆå„²å€¼å¾Œå†é€²è¡ŒæŠ•è³‡ã€‚</p>
    </div>
  </div>

  <!-- è½‰å¸³é é¢ -->
  <div id="transferPage" class="card hidden">
    <h2>è½‰å¸³è³‡è¨Š</h2>
    <div style="display: flex; gap: 2rem;">
      <div style="flex: 1;">
        <p><strong>æ´‹è¡Œä¿¡è¨—å°ˆå±¬åŒ¯æ¬¾è³‡è¨Š</strong></p>
        <p style="color: red; font-size: 1rem;">âš  è«‹é»æ“Šå·¦ä¸‹æ‰‹æ©Ÿç¬¦è™Ÿé€²è¡Œè½‰å¸³å‹•ä½œã€‚</p>
      </div>
      <div style="flex: 1;">
        <table border="1" style="width: 100%; text-align: left; border-collapse: collapse;">
          <tr><th>éŠ€è¡Œåç¨±</th><td>æ´‹è¡Œä¿¡è¨—</td></tr>
          <tr><th>éŠ€è¡Œä»£ç¢¼</th><td>123</td></tr>
          <tr><th>å¸³æˆ¶åç¨±</th><td>æ´‹è¡Œæœ‰è‚¡ä»½å…¬å¸</td></tr>
          <tr><th>æˆ‘çš„å°ˆå±¬å¸³æˆ¶</th><td>1234-5678-9012</td></tr>
        </table>
      </div>
    </div>
  </div>
  
 <!-- ğŸ“± æ‰‹æ©Ÿæ¨¡æ“¬æŒ‰éˆ• + é€šçŸ¥å®¹å™¨ -->
 <div id="mobile-container" style="position: fixed; bottom: 1rem; left: 1rem; z-index: 1000; display: flex; align-items: center; gap: 0.5rem;">
  <button onclick="toggleMobilePreview()" style="font-size: 3rem; background: none; border: none; cursor: pointer;">ğŸ“±</button>
  <div id="group-feedback-container" style="position: relative;">
    <!-- å½ˆå‡ºæç¤ºå€åŸŸ -->
    <div id="groupFeedback" class="group-feedback hidden">
      <img src="https://via.placeholder.com/42x42.png?text=Avata" alt="Avatar" class="avatar" />
      <div class="text-content">
        <div class="app-name">æŠ•è³‡ç¾¤çµ„</div>
        <div class="message" id="notificationMessage">é˜¿æ˜ï¼šå·²ç¶“å¢é•·äº† $500ï¼</div>
      </div>
    </div>
  </div>
</div>

    <!-- JS å‹•æ…‹å¡å…¥çš„é€šçŸ¥è¨Šæ¯ -->
  </div>
</div>

  <div id="group-feedback-container" class="absolute top-0 left-full ml-2 flex flex-col space-y-2"></div>
  <!-- æ‰‹æ©Ÿæ¨¡æ“¬è¦–çª— -->
  <div id="mobilePreview" class="mobile-preview">
  <!-- ä¸Šæ–¹è½ç­’ -->
  <div class="top-bar"><div class="speaker"></div></div>

  <!-- ä¸»ç•«é¢ -->
    <div class="screen">
      <!-- ç¾¤çµ„æç¤ºæµ®å‡ºè¨Šæ¯ -->
      <div id="groupFeedback" class="group-feedback hidden">
        <div class="notification">
          <img src="line-icon.png" alt="Avatar" class="avatar" />
          <div>
            <div class="app-name">æŠ•è³‡ç¾¤çµ„</div>
            <div class="message" id="notificationMessage">é˜¿æ˜ï¼šå·²ç¶“å¢é•·äº† $500ï¼</div>
          </div>
        </div>
      </div>

      <!-- é¦–é åœ–ç¤ºæ ¼ -->
      <div class="app-grid" id="appGrid">
          <div class="app" id="lineApp">
            <img src="https://i.imgur.com/SbCsymw.png" alt="LINE">
            <div class="app-label">LINE</div>
          </div>
          <div class="app" id="transferApp">
            <img src="https://i.imgur.com/j2kjeTK.png" alt="éŠ€è¡Œ">
            <div class="app-label">éŠ€è¡Œ</div>
          </div>
          <div class="app" id="facebookApp">
            <img src="https://imgur.com/POxoxxw.png" alt="Facebook">
            <div class="app-label">Facebook</div>
          </div>
        </div>

      <!-- LINE ç¾¤çµ„èŠå¤©å®¤å…§å®¹ -->
        <div id="lineChat" class="line-chat" style="display: none;">
          <div class="chat-header">
            <span class="chat-title">ç™¼å¤§è²¡(20)</span>
            <button id="lineBack" class="chat-back">é€€å‡º</button>
          </div>
          <div class="chat-messages" id="chatMessages">
            <div class="chat-system-msg">ä½ å·²æˆåŠŸåŠ å…¥ç™¼å¤§è²¡æŠ•è³‡ç¾¤çµ„</div>

            <div class="chat-msg">
              <img src="line-icon.png" class="avatar">
              <div class="chat-bubble">
                <div class="chat-name">é˜¿è²¡å“¥</div>
                <div class="chat-text">æ­¡è¿åŠ å…¥!!</div>
              </div>
            </div>

            <div class="chat-msg">
              <img src="line-icon.png" class="avatar">
              <div class="chat-bubble">
                <div class="chat-name">å°æ˜</div>
                <div class="chat-text">ä¸€èµ·ä¾†è³ºéŒ¢äº†</div>
              </div>
            </div>

            <div class="chat-msg">
              <img src="line-icon.png" class="avatar">
              <div class="chat-bubble">
                <div class="chat-name">å°ç¾</div>
                <div class="chat-text">æˆ‘æœ€è¿‘è³ºäº†å¥½å¤š</div>
              </div>
            </div>

            <div class="chat-msg">
              <img src="line-icon.png" class="avatar">
              <div class="chat-bubble">
                <div class="chat-name">é˜¿è²¡å“¥</div>
                <div class="chat-text">æ–°åŠ å…¥çš„æˆå“¡æœƒå…ˆçµ¦2000çš„æŠ•è³‡é‡‘!!è¦ä¸è¦å…ˆè©¦è©¦</div>
              </div>
            </div>

            <div class="chat-msg self">
              <div class="chat-bubble self">
                æˆ‘ä¹Ÿæƒ³è©¦è©¦ï¼
              </div>
            </div>
          </div>
          <div class="chat-input">
            <input type="text" placeholder="è¼¸å…¥è¨Šæ¯...">
            <button class="send-button">é€å‡º</button>
          </div>
        </div>

      <!-- è½‰å¸³å…§å®¹ -->
      <div class="transferSection" style="display:none;">
        <h3>è½‰å¸³è³‡è¨Š</h3>
        <p>è«‹å°‡æ¬¾é …åŒ¯è‡³ä»¥ä¸‹å¸³è™Ÿé€²è¡Œå„²å€¼ï¼š</p>
        <p><strong>æ´‹è¡Œä¿¡è¨—(123)1234-5678-9012</strong></p>

        <label for="mobileTransferAmount"><strong>è½‰å¸³é‡‘é¡</strong></label>
        <input id="mobileTransferAmount" type="number" class="form-input" placeholder="è¼¸å…¥é‡‘é¡">

        <button class="button" id="mobileConfirmTransfer">âœ… ç¢ºèªè½‰å¸³</button>
        <button class="button" id="backToApps" style="margin-top:1rem; background:#ccc; color:#333;">ğŸ”™ è¿”å›</button>
      </div>

      <!-- æ‰‹æ©Ÿå…§çš„é€šçŸ¥ -->
      <div id="mobileNotification" class="mobile-notification hidden">
        <div class="notification-content">
          <p id="notificationMessage">è½‰å¸³è™•ç†ä¸­...</p>
        </div>
      </div>
    </div>
  </div>

    <!-- ä¸‹æ–¹ Home éµ -->
    <div class="bottom-bar"><div class="home-button"></div></div>
  </div>


  <!-- æç¾é é¢ -->
  <div id="withdrawPage" class="withdraw-section card hidden">

    <h2>æç¾è™›æ“¬è²¨å¹£</h2>

    <!-- æç¾é‡‘é¡æ¬„ä½ -->
    <label for="withdrawAmount"><strong>æç¾é‡‘é¡</strong></label>
    <input type="number" id="withdrawAmount" placeholder="è¼¸å…¥æç¾é‡‘é¡" class="form-input" />

    <!-- éŠ€è¡Œä»£ç¢¼æ¬„ä½ -->
    <label for="bankCode"><strong>éŠ€è¡Œä»£ç¢¼</strong></label>
    <input type="text" id="bankCode" placeholder="ä¾‹å¦‚ï¼šä¸­åœ‹ä¿¡è¨—ç‚º 822" class="form-input" />

    <!-- éŠ€è¡Œå¸³è™Ÿæ¬„ä½ -->
    <label for="bankAccount"><strong>éŠ€è¡Œå¸³è™Ÿ</strong></label>
    <input type="text" id="bankAccount" placeholder="è¼¸å…¥éŠ€è¡Œå¸³è™Ÿ" class="form-input" />

    <!-- é©—è­‰ç¢¼å€åŸŸï¼šè¼¸å…¥æ¬„ä½ + ç™¼é€æŒ‰éˆ•ä¸¦æ’ -->
    <div class="otp-container">
      <input type="text" id="otpCode" placeholder="6 ä½é©—è­‰ç¢¼" class="form-input otp-input" />
      <button id="sendOtpButton" class="otp-button" onclick="sendOtpCode()">ç™¼é€é©—è­‰ç¢¼</button>
    </div>
    <span id="otpCountdown" class="otp-countdown"></span>


    <!-- è­¦å‘Šæç¤º -->
    <p style="color: red; font-size: 0.9rem; margin-top: 8px;">
      âš  éŠ€è¡Œå¸³è™Ÿèˆ‡éŠ€è¡Œä»£ç¢¼è«‹ç¢ºèªç„¡èª¤ï¼Œä¸¦ç¢ºä¿é©—è­‰ç¢¼æœ‰æ•ˆå†é€å‡ºç”³è«‹ã€‚
    </p>


    <!-- æŒ‰éˆ•å€ -->
    <div style="display: flex; flex-direction: column; gap: 10px; margin-top: 20px;">
      <button class="button" onclick="confirmWithdraw()">âœ… é€å‡ºæç¾ç”³è«‹</button>
      <button class="button" onclick="goBack()">è¿”å›</button>
    </div>

    <!-- æç¾é€šçŸ¥æ¡† -->
    <div id="withdrawNotice" class="withdraw-notice ">
      <span class="notice-title">âœ… æç¾ç”³è«‹å·²æäº¤</span>
      <span class="notice-message">æ‚¨çš„æç¾ç”³è«‹å·²æ”¶åˆ°ï¼Œé è¨ˆè™•ç†æ™‚é–“ç‚º 2â€“3 å€‹å·¥ä½œå¤©ã€‚</span>
    </div>
</div>

    <div id="subtitleOverlay" class="hidden">
    <div id="subtitleBox">éäº†å¹¾å¤©......</div>
    </div>
    <div id="userFeeling" class="hidden">æ²’æƒ³åˆ°å°è³ºäº†ä¸å°‘!!è©¦è©¦çœ‹é ˜å‡ºä¾†ä¸€äº›</div>

    <div id="customAlert" style="display: none; position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%);
    background-color: #fefefe; border: 1px solid #ccc; padding: 10px 20px; border-radius: 10px; box-shadow: 0 0 10px rgba(0,0,0,0.2);
    font-size: 14px; z-index: 1000; max-width: 90%; text-align: center;">
    </div>

  <script>
    const originalInvestmentHTML = document.getElementById('investmentPanel').innerHTML;

    let accountBalance = 2000;
    let currentCurrency = "BTC";
    let currentCurrencyPrice = 2000;
    let investedAmount = 0;
    let currentReturn = 0;
    let currencyPurchased = 0;
    let hasShownFeedback = false;

    const groupContainer = document.getElementById('group-feedback-container');
    const feedbackMessages = [
      "é˜¿æ˜ï¼šæˆ‘æ‰å‰›æŠ•å·²ç¶“å¢é•·äº†500ï¼",
      "å°ç¾ï¼šæˆ‘å¤šè³ºäº†å¥½å¤š!",
    ];


    function showGroupFeedback(message) {
      const feedback = document.getElementById('groupFeedback');
      const messageBox = feedback.querySelector('#notificationMessage');

      // æ›´æ–°è¨Šæ¯å…§å®¹
      messageBox.textContent = message;

      // é¡¯ç¤ºé€šçŸ¥
      feedback.classList.add('show-banner');
      feedback.classList.remove('hidden');

      // 4ç§’å¾Œéš±è—é€šçŸ¥
      setTimeout(() => {
        feedback.classList.remove('show-banner');
        feedback.classList.add('hidden');
      }, 4000);
    }

    function formatWithPercent(value, percent) {
      return `$${value.toFixed(2)} (+${percent}%)`;
    }

    function updateRealtimeReport() {
      let totalValue = accountBalance + currentReturn;
      let percent = investedAmount ? ((currentReturn / investedAmount) * 100).toFixed(2) : "0.00";

      // ä¿®æ”¹é€™ä¸€è¡Œï¼šå¸³æˆ¶ç¸½é¡åªé¡¯ç¤ºç´”é‡‘é¡ï¼Œä¸åŠ  percent
      document.getElementById('accountTotal').textContent = `$${totalValue.toFixed(2)}`;

      // ä»¥ä¸‹ä¿ç•™é¡¯ç¤ºç™¾åˆ†æ¯”çµ¦å›å ±æ•¸å€¼å³å¯
      document.getElementById('currentReturn').textContent = formatWithPercent(currentReturn, percent);
      document.getElementById('currentCurrencyPrice').textContent = `$${currentCurrencyPrice.toLocaleString()} (+5%)`;
    
    }


    function updateCurrencyDetails() {
      let selected = document.getElementById('currencySelect');
      if (!selected) return; // â›‘ é˜²æ­¢éŒ¯èª¤åŸ·è¡Œ

      let selectedCurrency = selected.value;
      let price = selected.options[selected.selectedIndex].dataset.price;
      currentCurrencyPrice = parseFloat(price);
      currentCurrency = selectedCurrency;
      document.getElementById('currencyPriceDisplay').textContent = `$${currentCurrencyPrice.toLocaleString()}`;
      document.getElementById('currencySymbol').textContent = selectedCurrency;
      updateEstimates();
    }
    //é–‹å•Ÿæ‰‹æ©Ÿæ¨¡æ“¬ä»‹é¢
    function confirmTransfer() {
      document.getElementById('accountRow').style.display = 'table-row';
    }

    function toggleMobilePreview() {
      const preview = document.getElementById('mobilePreview');
      preview.style.display = preview.style.display === 'none' ? 'block' : 'none';
    }


    function updateEstimates() {
      const amount = parseFloat(document.getElementById('investmentAmount').value);
      if (isNaN(amount) || amount <= 0) {
        document.getElementById('estimatedUnits').textContent = "0";
        document.getElementById('estimatedProfit').textContent = "$0.00 ~ $0.00";
        return;
      }
      const units = amount / currentCurrencyPrice;
      const lowProfit = amount * 0.02;
      const highProfit = amount * 0.04;
      document.getElementById('estimatedUnits').textContent = units.toFixed(4);
      document.getElementById('estimatedProfit').textContent = `$${lowProfit.toFixed(2)} ~ $${highProfit.toFixed(2)}`;
      document.getElementById('currencySymbol').textContent = currentCurrency;
    }

    let hasShownInvestmentFeedback = false;
    let hasShownFollowUpOptions = false;


    
  function confirmInvestment() {
  let amount = parseFloat(document.getElementById('investmentAmount').value);
  if (isNaN(amount) || amount <= 0 || amount > accountBalance) {
    showCustomAlert("æŠ•è³‡é‡‘é¡ä¸è¶³", "è«‹å…ˆå„²å€¼å¾Œå†é€²è¡ŒæŠ•è³‡(éŠæˆ²æç¤ºï¼šè«‹é¸æ“‡å³ä¸Šè½‰å¸³)");
    return;
  }

  confirmClickCount++; // åªè¦é‡‘é¡OKï¼Œå†å¢åŠ é»æ“Šæ¬¡æ•¸

  if (confirmClickCount === 1) {
    // ç¬¬ä¸€æ¬¡é»æ“Šï¼šæ­£å¸¸æŠ•è³‡æµç¨‹
    executeInvestment(amount);

    // é¡¯ç¤ºè³¼è²·æˆåŠŸè¨Šæ¯
    showPurchaseSuccess("è³¼è²·æˆåŠŸï¼");

    // é¡¯ç¤ºç¾¤çµ„åé¥‹
    if (!hasShownInvestmentFeedback) {
      let randomIndexes = [];
      while (randomIndexes.length < 2) {
        let randomIndex = Math.floor(Math.random() * feedbackMessages.length);
        if (!randomIndexes.includes(randomIndex)) {
          randomIndexes.push(randomIndex);
        }
      }
      showGroupFeedback(feedbackMessages[randomIndexes[0]]);
      setTimeout(() => {
        showGroupFeedback(feedbackMessages[randomIndexes[1]]);
      }, 5000);

      hasShownInvestmentFeedback = true;
    }

    // é¡¯ç¤ºåŠ ç¢¼é¸å–®
    if (!hasShownFollowUpOptions) {
      setTimeout(() => {
        document.getElementById('followUpOptions').classList.remove('hidden');
      }, 10000); // åŠ ç¢¼é¸å–®å»¶é²å‡ºç¾
      hasShownFollowUpOptions = true;
    }

    } else if (confirmClickCount === 2) {
    // ç¬¬äºŒæ¬¡é»æ“Šï¼šå†æ‰£ä¸€æ¬¡éŒ¢
    executeInvestment(amount);

    // é¡¯ç¤ºè³¼è²·æˆåŠŸè¨Šæ¯
    showPurchaseSuccess("è³¼è²·æˆåŠŸï¼");

    // ğŸŒŸ è¢å¹•æš—æ‰ + åŠ å¤§é‡å›å ±é‡‘é¡
    setTimeout(() => {
      const overlay = document.getElementById('subtitleOverlay');
      overlay.classList.remove('hidden');
      overlay.classList.add('show');

      // åŠ å¤§é‡å›å ±é‡‘é¡ï¼ˆ50%~100%ï¼‰
      let fakeProfit = investedAmount * (Math.random() * 0.5 + 0.5);
      fakeProfit = Math.round(fakeProfit);

      accountBalance += fakeProfit;
      currentReturn += fakeProfit;

      updateRealtimeReport();
      document.getElementById('newAccountBalance').textContent = `$${accountBalance.toFixed(2)}`;

        // é—œæ‰å­—å¹• & é¡¯ç¤ºå¿ƒæƒ…èªå¥
        setTimeout(() => {
        overlay.classList.remove('show');
        overlay.classList.add('hidden');

        // é¡¯ç¤ºä½¿ç”¨è€…å¿ƒæƒ…èªå¥
        const feeling = document.getElementById('userFeeling');
        feeling.classList.remove('hidden');
        feeling.classList.add('show');

        // å¹¾ç§’å¾Œè‡ªå‹•æ·¡å‡º
        setTimeout(() => {
          feeling.classList.remove('show');
          feeling.classList.add('hidden');
        }, 4000);

      }, 4000);

    }, 7000);
  }
}

  // âœ… æŠŠæ‰£éŒ¢é‚è¼¯çµ±ä¸€æˆ function
  function executeInvestment(amount) {
    accountBalance -= amount;
    investedAmount += amount;
    currencyPurchased = amount / currentCurrencyPrice;
    let initialReturn = amount * 0.02;
    let finalReturn = amount * 0.04;
    currentReturn += initialReturn;

    document.getElementById('currencyPurchased').textContent = currencyPurchased.toFixed(4);
    document.getElementById('newAccountBalance').textContent = `$${accountBalance.toFixed(2)}`;

    updateRealtimeReport();
    startReturnGrowth(currentReturn, currentReturn + (finalReturn - initialReturn), 10000);

    document.getElementById('investmentResult').style.display = 'block';
  }

  // âœ… é¡¯ç¤ºè³¼è²·æˆåŠŸè¨Šæ¯
  function showPurchaseSuccess(message) {
    const purchaseSuccess = document.getElementById('purchaseSuccess');
    purchaseSuccess.textContent = message;
    purchaseSuccess.classList.remove('hidden');
    purchaseSuccess.classList.add('show');

    setTimeout(() => {
      purchaseSuccess.classList.remove('show');
      purchaseSuccess.classList.add('hidden');
    }, 2000); // 2ç§’å¾Œè‡ªå‹•é—œæ‰
  }


    // çµ±ä¸€æ‰£éŒ¢çš„ function
    function executeInvestment(amount) {
      accountBalance -= amount;
      investedAmount += amount;
      currencyPurchased = amount / currentCurrencyPrice;
      let initialReturn = amount * 0.02;
      let finalReturn = amount * 0.04;
      currentReturn += initialReturn;

      document.getElementById('currencyPurchased').textContent = currencyPurchased.toFixed(4);
      document.getElementById('newAccountBalance').textContent = `$${accountBalance.toFixed(2)}`;

      updateRealtimeReport();
      startReturnGrowth(currentReturn, currentReturn + (finalReturn - initialReturn), 10000);

      document.getElementById('investmentResult').style.display = 'block';
    }

    // é¡¯ç¤ºè³¼è²·æˆåŠŸçš„å°é€šçŸ¥
    function showPurchaseSuccess(message) {
      const purchaseSuccess = document.getElementById('purchaseSuccess');
      purchaseSuccess.textContent = message;
      purchaseSuccess.classList.remove('hidden');
      purchaseSuccess.classList.add('show');

      setTimeout(() => {
        purchaseSuccess.classList.remove('show');
        purchaseSuccess.classList.add('hidden');
      }, 2000); // é¡¯ç¤º2ç§’å¾Œè‡ªå‹•æ¶ˆå¤±
    }

    function startReturnGrowth(startValue, endValue, duration) {
      const steps = 100;
      const increment = (endValue - startValue) / steps;
      let current = startValue;
      let count = 0;
      const interval = setInterval(() => {
        current += increment;
        currentReturn = current;
        count++;
        updateRealtimeReport();
        if (count >= steps) {
          clearInterval(interval);
        }
      }, duration / steps);
    }

    function handleFollowUpOption(option) {
      let amount = option === 'A' ? 2000 : 1000;
      document.getElementById('investmentAmount').value = amount;
      updateEstimates();
      confirmInvestment();
      document.getElementById('followUpOptions').classList.add('hidden');
    }

    function startGroupBannerNotifications() {
      const feedback = document.getElementById('groupFeedback');
      const messageText = document.getElementById('notificationMessage');
      const messages = feedbackMessages;
      let index = 0;

      function showMessage() {
        if (index >= messages.length) return;
        messageText.textContent = messages[index];
        feedback.classList.remove('hidden', 'slide-up');
        feedback.classList.add('show-banner');

        setTimeout(() => {
          feedback.classList.add('slide-up');
        }, 4000);

        setTimeout(() => {
          feedback.classList.remove('show-banner');
          feedback.classList.add('hidden');
          index++;
          setTimeout(showMessage, 1000);
        }, 5000);
      }

      showMessage();
    }

    function showCustomAlert(title, message) {
      const alertBox = document.getElementById('customAlert');
      if (!alertBox) return;

      const strongEl = alertBox.querySelector('strong');
      const messageEl = alertBox.querySelector('p');

      strongEl.textContent = title;
      messageEl.textContent = message;

      alertBox.classList.remove('hidden');
      alertBox.style.display = 'block';

      setTimeout(() => {
        alertBox.style.display = 'none';
        alertBox.classList.add('hidden');
      }, 4000);
    }

    function handleDropdownChange() {
      const selected = document.getElementById('moreOptions').value;
      const investmentPanel = document.getElementById('investmentPanel');
      const investmentResult = document.getElementById('investmentResult');
      const realtimeReport = document.getElementById('realtimeReport');

      // é¡¯ç¤ºå³æ™‚å›å ±å€å¡Š
      realtimeReport.style.display = 'block';

      // éš±è—å…¶ä»–åŠŸèƒ½å€å¡Š
      document.getElementById('withdrawPage').classList.add('hidden');
      document.getElementById('followUpOptions').classList.add('hidden');
      document.getElementById('groupFeedback').classList.add('hidden');
      document.getElementById('customAlert').classList.add('hidden');

      // æ¢å¾©æŠ•è³‡å€å¡Šçš„å…§å®¹
      investmentPanel.innerHTML = originalInvestmentHTML;
      investmentPanel.style.display = 'block';
      investmentResult.style.display = 'none';

      // æ ¹æ“šé¸é …åˆ‡æ›å…§å®¹
      if (selected === 'transfer') {
        investmentPanel.innerHTML = document.getElementById('transferPage').innerHTML;

        setTimeout(() => {
          const btn = investmentPanel.querySelector('button');
          if (btn) {
            btn.addEventListener('click', confirmTransfer);
          }
        }, 0);
      } else if (selected === 'withdraw') {
        investmentPanel.style.display = 'none';
        investmentResult.style.display = 'none';
        document.getElementById('withdrawPage').classList.remove('hidden');
      }

      updateCurrencyDetails(); // é‡æ–°ç¶å®šå¹£ç¨®æ›´æ–°
    }



    function confirmTransfer() {
      const amount = parseFloat(document.getElementById('transferAmount').value);
      if (isNaN(amount) || amount <= 0) {
        alert('è«‹è¼¸å…¥æœ‰æ•ˆçš„è½‰å¸³é‡‘é¡');
        return;
      }

      // å¢åŠ åˆ°å¸³æˆ¶ç¸½é¡
      accountBalance += amount;

      // æ›´æ–°ç•«é¢
      updateRealtimeReport();

      // é¡¯ç¤ºæç¤ºï¼ˆå¯é¸ï¼‰
      showCustomAlert("å„²å€¼æˆåŠŸ", `æ‚¨å·²æˆåŠŸå„²å€¼ $${amount.toFixed(0)}è‡³æ­¤å¸³æˆ¶`);

      // æ¸…ç©ºæ¬„ä½ï¼ˆå¯é¸ï¼‰
      document.getElementById('transferAmount').value = '';
    }

      // æç¾åŠŸèƒ½
      function confirmWithdraw() {
        const amount = parseFloat(document.getElementById('withdrawAmount').value);
        const bankCode = document.getElementById('bankCode').value.trim();
        const bankAccount = document.getElementById('bankAccount').value.trim();
        const otpCode = document.getElementById('otpCode').value.trim();

        if (isNaN(amount) || amount <= 0) {
          showCustomAlert("æç¾é‡‘é¡éŒ¯èª¤", "è«‹è¼¸å…¥æœ‰æ•ˆçš„é‡‘é¡");
          return;
        }

        if (!/^\d{3}$/.test(bankCode)) {
          showCustomAlert("éŠ€è¡Œä»£ç¢¼éŒ¯èª¤", "è«‹è¼¸å…¥ 3 ä½æ•¸çš„éŠ€è¡Œä»£ç¢¼ï¼ˆä¾‹å¦‚ 822ï¼‰");
          return;
        }

        if (bankAccount.length < 5) {
          showCustomAlert("éŠ€è¡Œå¸³è™ŸéŒ¯èª¤", "è«‹è¼¸å…¥æœ‰æ•ˆçš„éŠ€è¡Œå¸³è™Ÿ");
          return;
        }

        if (!/^\d{6}$/.test(otpCode)) {
          showCustomAlert("é©—è­‰ç¢¼éŒ¯èª¤", "è«‹è¼¸å…¥ 6 ä½æ•¸é©—è­‰ç¢¼");
          return;
        }

        // é¡¯ç¤ºæç¤ºé€šçŸ¥ï¼Œä¸é€²è¡Œæ‰£æ¬¾
          showWithdrawNotice("æç¾ç”³è«‹å·²æäº¤", "æ‚¨çš„æç¾ç”³è«‹å·²æ”¶åˆ°ï¼Œé è¨ˆè™•ç†æ™‚é–“ç‚º 2â€“3 å€‹å·¥ä½œå¤©ã€‚");

        // æ¸…ç©ºæ¬„ä½
        document.getElementById('withdrawAmount').value = '';
        document.getElementById('bankCode').value = '';
        document.getElementById('bankAccount').value = '';
        document.getElementById('otpCode').value = '';
      }

      // é©—è­‰ç¢¼
      function sendOtpCode() {
        const otp = Math.floor(100000 + Math.random() * 900000);
        document.getElementById('otpCode').value = otp;

        // é€™è£¡è¦æ”¹æˆè·Ÿå‡½å¼åç¨±ä¸€æ¨£
        showOtpNotification(otp);

        const btn = document.getElementById('sendOtpButton');
        let countdown = 60;

        btn.disabled = true;
        btn.innerText = `é©—è­‰ç¢¼å·²ç™¼é€ (${countdown}s)`;

        const timer = setInterval(() => {
          countdown--;
          btn.innerText = `é©—è­‰ç¢¼å·²ç™¼é€ (${countdown}s)`;

          if (countdown <= 0) {
            clearInterval(timer);
            btn.disabled = false;
            btn.innerText = "ç™¼é€é©—è­‰ç¢¼";
          }
        }, 1000);
      }

      function showOtpNotification(otp) {
        const message = `æ‚¨çš„é©—è­‰ç¢¼æ˜¯ï¼š${otp}ï¼Œ\nè«‹æ–¼ 5 åˆ†é˜å…§å®Œæˆé©—è­‰ã€‚`;

        const groupContainer = document.getElementById('group-feedback-container');
        const messageElement = document.createElement('p');
        messageElement.textContent = message;
        messageElement.classList.add('message', 'otp-message');

        groupContainer.appendChild(messageElement);
        groupContainer.scrollTop = groupContainer.scrollHeight;

        // ğŸ•’ 2ç§’å¾Œç§»é™¤è¨Šæ¯
        setTimeout(() => {
          messageElement.remove();
        }, 3000);
      }

       // é€šçŸ¥æ¡†
      function showWithdrawNotice(title, message) {
        const notice = document.getElementById("withdrawNotice");
        // å¯é¸ï¼šå‹•æ…‹æ›´æ–°å…§å®¹
        notice.querySelector(".notice-title").textContent = title;
        notice.querySelector(".notice-message").textContent = message;

        // ç§»é™¤ hiddenï¼Œä¸¦åŠ å…¥ show
        notice.classList.remove("hidden");
        notice.classList.add("show");

        setTimeout(() => {
          notice.classList.remove("show");
          notice.classList.add("hidden");
        }, 3000);
      }

    function showMobileAlert(title, message) {
    const alertBox = document.getElementById('mobileAlertBox');
    const alertTitle = document.getElementById('mobileAlertTitle');
    const alertMessage = document.getElementById('mobileAlertMessage');

    alertTitle.textContent = title;
    alertMessage.textContent = message;

    alertBox.classList.remove('hidden');
    alertBox.classList.add('show');

    setTimeout(() => {
      alertBox.classList.remove('show');
      setTimeout(() => {
        alertBox.classList.add('hidden');
      }, 400); // è®“ transition çµæŸå¾Œå†éš±è—
    }, 3000); // é¡¯ç¤º 3 ç§’
  }

      function goBack() {
        // éš±è—è½‰å¸³å’Œæç¾é é¢
        document.getElementById('transferPage').classList.add('hidden');
        document.getElementById('withdrawPage').classList.add('hidden');

        // é¡¯ç¤ºæŠ•è³‡ä¸»é é¢
        document.getElementById('investmentPanel').style.display = 'block';

        // è‹¥æœ‰ä¸»å®¹å™¨ï¼Œä¹Ÿå¯ä»¥ä¸€èµ·é¡¯ç¤ºï¼ˆä¾ç…§ä½ çš„è¨­è¨ˆè€Œå®šï¼‰
        document.querySelector('.container').style.display = 'block';

        // æ¸…ç©ºé¸å–®
        document.getElementById('moreOptions').value = "";

        // éš±è—æŠ•è³‡çµæœå€ï¼ˆå¯é¸ï¼‰
        const result = document.getElementById('investmentResult');
        if (result) result.style.display = 'none';
      }


    const transferFormHTML = `
      <h2>è½‰å¸³è³‡è¨Š</h2>
      <div style="display: flex; gap: 2rem;">
        <div style="flex: 1;">
          <p><strong>æ´‹è¡Œä¿¡è¨—å°ˆå±¬åŒ¯æ¬¾è³‡è¨Š</strong></p>
          <p style="color: red; font-size: 0.9rem;">âš  å„²å€¼å¾Œè«‹é‡æ–°æ•´ç†é é¢å³å¯æ›´æ–°é¤˜é¡ã€‚</p>
        </div>
        <div style="flex: 1;">
          <table border="1" style="width: 100%; text-align: left; border-collapse: collapse;">
            <tr><th>éŠ€è¡Œåç¨±</th><td>æ´‹è¡Œä¿¡è¨—</td></tr>
            <tr><th>éŠ€è¡Œä»£ç¢¼</th><td>123</td></tr>
            <tr><th>å¸³æˆ¶åç¨±</th><td>æ´‹è¡Œæœ‰è‚¡ä»½å…¬å¸</td></tr>
            <tr><th>æˆ‘çš„å°ˆå±¬å¸³æˆ¶</th><td>1234-5678-9012</td></tr>
          </div>
      </div>
    `;


    function openApp(appName) {
      const screen = document.querySelector('.mobile-preview .screen');
      const allScreens = screen.querySelectorAll('div');
      
      // éš±è—æ‰€æœ‰å…§é ç•«é¢
      allScreens.forEach(div => div.style.display = 'none');

      if (appName === 'è½‰å¸³') {
        const transferScreen = screen.querySelector('.transfer-screen');
        if (transferScreen) {
          transferScreen.style.display = 'block';
        }
      }
    }


    function updateCurrencyDetails() {
      let selected = document.getElementById('currencySelect');
      if (!selected) return;

      let selectedCurrency = selected.value;
      let price = selected.options[selected.selectedIndex].dataset.price;
      currentCurrencyPrice = parseFloat(price);
      currentCurrency = selectedCurrency;

      document.getElementById('currencyPriceDisplay').textContent = `$${currentCurrencyPrice.toLocaleString()}`;
      document.getElementById('currencySymbol').textContent = selectedCurrency;

      // âœ… é€™è¡Œæ˜¯æ–°å¢çš„ï¼Œç”¨ä¾†æ›´æ–°å³å´å³æ™‚å›å ±çš„åƒ¹æ ¼é¡¯ç¤º
      document.getElementById('currentCurrencyPrice').textContent = `$${currentCurrencyPrice.toLocaleString()}`;

      updateEstimates();
    }

    document.getElementById('mobileConfirmTransfer').addEventListener('click', function () {
    const amountInput = document.getElementById('mobileTransferAmount');
    const amount = parseFloat(amountInput.value);

    if (isNaN(amount) || amount <= 0) {
      alert('â—è«‹è¼¸å…¥æœ‰æ•ˆçš„è½‰å¸³é‡‘é¡');
      return;
    }

    // é¡¯ç¤ºç¢ºèªå°è©±æ¡†
    const confirmed = confirm(`è«‹ç¢ºèªæ‚¨å·²å®Œæˆè½‰å¸³ $${amount.toFixed(0)}ï¼Œæ˜¯å¦è¦é€å‡ºç¢ºèªï¼Ÿ`);
    if (!confirmed) return;

    // é¡¯ç¤ºæ‰‹æ©Ÿæ¨¡æ“¬ä»‹é¢é€šçŸ¥
    const mobileNotification = document.getElementById('mobileNotification');
    const notificationMessage = document.getElementById('notificationMessage');
    mobileNotification.classList.add('show');
    notificationMessage.textContent = `è½‰å¸³è™•ç†ä¸­ $${amount.toFixed(0)}...`;

    // å‡è£è™•ç†ä¸­
    const button = this;
    button.disabled = true;
    button.textContent = "â³ è™•ç†ä¸­...";

    setTimeout(() => {
      // âœ… æ›´æ–°å¸³æˆ¶é‡‘é¡
      accountBalance += amount;
      updateRealtimeReport();

      // âœ… æç¤ºæˆåŠŸ
      showCustomAlert("å„²å€¼æˆåŠŸ", `æ‚¨å·²æˆåŠŸè½‰å¸³ $${amount.toFixed(0)} è‡³æ­¤å¸³æˆ¶`);

      // âœ… é‚„åŸæŒ‰éˆ•ç‹€æ…‹
      button.disabled = false;
      button.textContent = "âœ… ç¢ºèªè½‰å¸³";

      // âœ… æ¸…ç©ºè¼¸å…¥æ¬„ä½
      amountInput.value = '';

      // âœ… éš±è—é€šçŸ¥
      mobileNotification.classList.remove('show');
    }, 2500); // æ¨¡æ“¬ 2.5 ç§’è™•ç†æ™‚é–“
  });


    document.addEventListener('DOMContentLoaded', () => {
      const inlineBankInfo = document.getElementById('inlineBankInfo');
      const bankInfo = document.getElementById('fakeBankAccount')?.textContent;
      if (inlineBankInfo && bankInfo) {
        inlineBankInfo.textContent = bankInfo;
      }
    });

    setInterval(() => {
      let change = (Math.random() * 200 - 100);
      currentCurrencyPrice += change;
      updateCurrencyDetails();
      updateRealtimeReport();
    }, 8000);

    setTimeout(() => {
      const followUpOptions = document.getElementById('followUpOptions');
      followUpOptions.classList.add('hidden');
    }, 100);
    document.getElementById('moreOptions').addEventListener('change', handleDropdownChange);


    document.getElementById('transferApp').addEventListener('click', () => {
      document.querySelector('.transferSection').style.display = 'block';
      document.querySelector('.app-grid').style.display = 'none';
    });

    // é»æ“Šè¿”å›æŒ‰éˆ•
    document.getElementById('backToApps').addEventListener('click', () => {
      document.querySelector('.transferSection').style.display = 'none';
      document.querySelector('.app-grid').style.display = 'flex';
    });
    function goBack() {
      // é¡¯ç¤ºæŠ•è³‡é¢æ¿
      document.getElementById('investmentPanel').style.display = 'block';

      // éš±è—æç¾é é¢
      document.getElementById('withdrawPage').classList.add('hidden');

      // éš±è—æŠ•è³‡çµæœå€ï¼ˆå¦‚æœéœ€è¦ï¼‰
      document.getElementById('investmentResult').style.display = 'none';

      // é‡æ–°åˆå§‹åŒ–å¹£ç¨®ç›¸é—œè³‡æ–™
      updateCurrencyDetails();
    }


    let confirmClickCount = 0;

  function confirmBuy() {
    const overlay = document.getElementById("overlay");
    const list = document.getElementById("list");

    confirmClickCount++;

    // éƒ½æœƒæ–°å¢ä¸€ç­†
    const newItem = document.createElement("div");
    newItem.className = "investment-item";
    newItem.style.padding = "10px";
    newItem.style.marginBottom = "10px";
    newItem.style.backgroundColor = "#333";
    newItem.style.color = "white";
    newItem.innerHTML = `
      <div>æŠ•è³‡é‡‘é¡ï¼š$3,000ï¼ˆå¾…ç¢ºèªï¼‰</div>
    `;
    list.appendChild(newItem);

    // ç¬¬äºŒæ¬¡æ‰æš—æ‰
    if (confirmClickCount === 2) {
      overlay.style.display = "flex";
      confirmClickCount = 0; // é‡ç½®è¨ˆæ•¸å™¨
    }
  }

    // é»æ“Š LINE App é€²å…¥èŠå¤©å®¤
    document.getElementById("lineApp").addEventListener("click", function () {
      document.getElementById("appGrid").style.display = "none";
      document.getElementById("lineChat").style.display = "block";
    });

    // è¿”å› App é¦–é 
    document.getElementById("lineBack").addEventListener("click", function () {
      document.getElementById("lineChat").style.display = "none";
      document.getElementById("appGrid").style.display = "grid";
    });

    // é»æ“Šæç¾æŒ‰éˆ• â†’ åŠ å…¥é€€å‡ºç¾¤çµ„è¨Šæ¯
    document.getElementById("withdrawButton").addEventListener("click", function () {
      const chatBox = document.getElementById("chatMessages");
      const msg = document.createElement("div");
      msg.className = "chat-msg";
      msg.textContent = "ç”¨æˆ¶B å·²é€€å‡ºç¾¤çµ„";
      chatBox.appendChild(msg);
    });



  </script>
</body>
</html>
